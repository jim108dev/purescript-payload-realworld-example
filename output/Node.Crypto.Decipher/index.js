// Generated by purs version 0.13.8
"use strict";
var $foreign = require("./foreign.js");
var Data_Show = require("../Data.Show/index.js");
var Node_Buffer = require("../Node.Buffer/index.js");
var Node_Buffer_Class = require("../Node.Buffer.Class/index.js");
var Node_Crypto_Cipher = require("../Node.Crypto.Cipher/index.js");
var Node_Encoding = require("../Node.Encoding/index.js");
var createDecipher = function (alg) {
    return function (password) {
        return $foreign["_createDecipher"](Data_Show.show(Node_Crypto_Cipher.showAlgorithm)(alg))(password);
    };
};
var decipher = function (alg) {
    return function (password) {
        return function (str) {
            return function (enc) {
                return function __do() {
                    var buf = Node_Buffer_Class.fromString(Node_Buffer.mutableBufferEffect)(str)(enc)();
                    var dec = createDecipher(alg)(password)();
                    var rbuf1 = $foreign.update(dec)(buf)();
                    var rbuf2 = $foreign["final"](dec)();
                    var rbuf = Node_Buffer_Class.concat(Node_Buffer.mutableBufferEffect)([ rbuf1, rbuf2 ])();
                    return Node_Buffer_Class.toString(Node_Buffer.mutableBufferEffect)(Node_Encoding.UTF8.value)(rbuf)();
                };
            };
        };
    };
};
var fromBase64 = function (alg) {
    return function (password) {
        return function (str) {
            return decipher(alg)(password)(str)(Node_Encoding.Base64.value);
        };
    };
};
var fromHex = function (alg) {
    return function (password) {
        return function (str) {
            return decipher(alg)(password)(str)(Node_Encoding.Hex.value);
        };
    };
};
module.exports = {
    fromHex: fromHex,
    fromBase64: fromBase64,
    createDecipher: createDecipher,
    update: $foreign.update,
    "final": $foreign["final"]
};
