// Generated by purs version 0.13.8
"use strict";
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Monad_Error_Class = require("../Control.Monad.Error.Class/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Eq = require("../Data.Eq/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Show = require("../Data.Show/index.js");
var Data_Symbol = require("../Data.Symbol/index.js");
var Effect_Aff = require("../Effect.Aff/index.js");
var Effect_Exception = require("../Effect.Exception/index.js");
var Payload_Client_DecodeResponse = require("../Payload.Client.DecodeResponse/index.js");
var Payload_ResponseTypes = require("../Payload.ResponseTypes/index.js");
var DecodeError = (function () {
    function DecodeError(value0) {
        this.value0 = value0;
    };
    DecodeError.create = function (value0) {
        return new DecodeError(value0);
    };
    return DecodeError;
})();
var StatusError = (function () {
    function StatusError(value0) {
        this.value0 = value0;
    };
    StatusError.create = function (value0) {
        return new StatusError(value0);
    };
    return StatusError;
})();
var RequestError = (function () {
    function RequestError(value0) {
        this.value0 = value0;
    };
    RequestError.create = function (value0) {
        return new RequestError(value0);
    };
    return RequestError;
})();
var showClientError = new Data_Show.Show(function (v) {
    if (v instanceof DecodeError) {
        return "DecodeError: " + Data_Show.show(Data_Show.showRecord()(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
            return "error";
        }))(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
            return "response";
        }))(Data_Show.showRecordFieldsNil)(Payload_ResponseTypes.showResponse(Data_Show.showString)))(Payload_Client_DecodeResponse.showDecodeResponseError)))(v.value0);
    };
    if (v instanceof StatusError) {
        return "StatusError: " + Data_Show.show(Data_Show.showRecord()(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
            return "response";
        }))(Data_Show.showRecordFieldsNil)(Payload_ResponseTypes.showResponse(Data_Show.showString))))(v.value0);
    };
    if (v instanceof RequestError) {
        return "RequestError: " + Data_Show.show(Data_Show.showRecord()(Data_Show.showRecordFieldsCons(new Data_Symbol.IsSymbol(function () {
            return "message";
        }))(Data_Show.showRecordFieldsNil)(Data_Show.showString)))(v.value0);
    };
    throw new Error("Failed pattern match at Payload.Client.Response (line 18, column 1 - line 21, column 57): " + [ v.constructor.name ]);
});
var unwrapBody = function (aff) {
    var unwrapError = function (err) {
        return Effect_Exception.error("Error unwrapping response body from Payload ClientResponse- attempted to unwrap " + ("client response body but response contained error: \x0a" + Data_Show.show(showClientError)(err)));
    };
    return Control_Bind.bind(Effect_Aff.bindAff)(aff)(function (result) {
        if (result instanceof Data_Either.Right) {
            return Control_Applicative.pure(Effect_Aff.applicativeAff)((Data_Newtype.unwrap(Payload_ResponseTypes.newtypeResponse)(result.value0)).body);
        };
        if (result instanceof Data_Either.Left) {
            return Control_Monad_Error_Class.throwError(Effect_Aff.monadThrowAff)(unwrapError(result.value0));
        };
        throw new Error("Failed pattern match at Payload.Client.Response (line 42, column 3 - line 44, column 45): " + [ result.constructor.name ]);
    });
};
var unwrapResponse = function (aff) {
    var unwrapError = function (err) {
        return Effect_Exception.error("Error unwrapping response from Payload ClientResponse - attempted to unwrap " + ("client response but response contained error: \x0a" + Data_Show.show(showClientError)(err)));
    };
    return Control_Bind.bind(Effect_Aff.bindAff)(aff)(function (result) {
        if (result instanceof Data_Either.Right) {
            return Control_Applicative.pure(Effect_Aff.applicativeAff)(Data_Newtype.unwrap(Payload_ResponseTypes.newtypeResponse)(result.value0));
        };
        if (result instanceof Data_Either.Left) {
            return Control_Monad_Error_Class.throwError(Effect_Aff.monadThrowAff)(unwrapError(result.value0));
        };
        throw new Error("Failed pattern match at Payload.Client.Response (line 31, column 3 - line 33, column 45): " + [ result.constructor.name ]);
    });
};
var eqClientError = new Data_Eq.Eq(function (v) {
    return function (v1) {
        if (v instanceof DecodeError && v1 instanceof DecodeError) {
            return Data_Eq.eq(Data_Eq.eqRec()(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(new Data_Symbol.IsSymbol(function () {
                return "response";
            }))(Payload_ResponseTypes.eqResponse(Data_Eq.eqString)))()(new Data_Symbol.IsSymbol(function () {
                return "error";
            }))(Payload_Client_DecodeResponse.eqDecodeResponseError)))(v.value0)(v1.value0);
        };
        if (v instanceof StatusError && v1 instanceof StatusError) {
            return Data_Eq.eq(Data_Eq.eqRec()(Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(new Data_Symbol.IsSymbol(function () {
                return "response";
            }))(Payload_ResponseTypes.eqResponse(Data_Eq.eqString))))(v.value0)(v1.value0);
        };
        if (v instanceof RequestError && v1 instanceof RequestError) {
            return Data_Eq.eq(Data_Eq.eqRec()(Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(new Data_Symbol.IsSymbol(function () {
                return "message";
            }))(Data_Eq.eqString)))(v.value0)(v1.value0);
        };
        return false;
    };
});
module.exports = {
    DecodeError: DecodeError,
    StatusError: StatusError,
    RequestError: RequestError,
    unwrapResponse: unwrapResponse,
    unwrapBody: unwrapBody,
    showClientError: showClientError,
    eqClientError: eqClientError
};
