// Generated by purs version 0.13.8
"use strict";
var Control_Alt = require("../Control.Alt/index.js");
var Control_Alternative = require("../Control.Alternative/index.js");
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Apply = require("../Control.Apply/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Control_Category = require("../Control.Category/index.js");
var Control_Monad = require("../Control.Monad/index.js");
var Control_Monad_Error_Class = require("../Control.Monad.Error.Class/index.js");
var Control_Monad_Except_Trans = require("../Control.Monad.Except.Trans/index.js");
var Control_Monad_Maybe_Trans = require("../Control.Monad.Maybe.Trans/index.js");
var Control_Monad_Reader_Class = require("../Control.Monad.Reader.Class/index.js");
var Control_Monad_State_Class = require("../Control.Monad.State.Class/index.js");
var Control_Monad_Trans_Class = require("../Control.Monad.Trans.Class/index.js");
var Control_Monad_Writer_Class = require("../Control.Monad.Writer.Class/index.js");
var Control_Plus = require("../Control.Plus/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_Monoid = require("../Data.Monoid/index.js");
var Data_Semigroup = require("../Data.Semigroup/index.js");
var Data_Tuple = require("../Data.Tuple/index.js");
var Data_Unit = require("../Data.Unit/index.js");
var Effect_Class = require("../Effect.Class/index.js");
var Pipes = require("../Pipes/index.js");
var Pipes_Core = require("../Pipes.Core/index.js");
var Pipes_Internal = require("../Pipes.Internal/index.js");
var Select = function (x) {
    return x;
};
var Enumerable = function (toListT) {
    this.toListT = toListT;
};
var toListT = function (dict) {
    return dict.toListT;
};
var maybeTEnumerable = new Enumerable(function (dictMonad) {
    return function (m) {
        return Select(Control_Bind.bind(Pipes_Internal.bindProxy(dictMonad))(Control_Monad_Trans_Class.lift(Pipes_Internal.monadTransProxy)(dictMonad)(Control_Monad_Maybe_Trans.runMaybeT(m)))(function (x) {
            if (x instanceof Data_Maybe.Nothing) {
                return Control_Applicative.pure(Pipes_Internal.applicativeProxy(dictMonad))(Data_Unit.unit);
            };
            if (x instanceof Data_Maybe.Just) {
                return Pipes["yield"](dictMonad)(x.value0);
            };
            throw new Error("Failed pattern match at Pipes.ListT (line 122, column 9 - line 124, column 31): " + [ x.constructor.name ]);
        }));
    };
});
var listTMonadTrans = new Control_Monad_Trans_Class.MonadTrans(function (dictMonad) {
    return function (m) {
        return Control_Bind.bind(Pipes_Internal.bindProxy(dictMonad))(Control_Monad_Trans_Class.lift(Pipes_Internal.monadTransProxy)(dictMonad)(m))(Pipes["yield"](dictMonad));
    };
});
var listTFunctor = function (dictMonad) {
    return new Data_Functor.Functor(function (f) {
        return function (v) {
            return Pipes["for"](dictMonad)(v)((function () {
                var $88 = Pipes["yield"](dictMonad);
                return function ($89) {
                    return $88(f($89));
                };
            })());
        };
    });
};
var listTEnumerable = new Enumerable(function (dictMonad) {
    return Control_Category.identity(Control_Category.categoryFn);
});
var listTApply = function (dictMonad) {
    return new Control_Apply.Apply(function () {
        return listTFunctor(dictMonad);
    }, function (v) {
        return function (v1) {
            return Pipes["for"](dictMonad)(v)(function (f) {
                return Pipes["for"](dictMonad)(v1)(function (x) {
                    return Pipes["yield"](dictMonad)(f(x));
                });
            });
        };
    });
};
var listTApplicative = function (dictMonad) {
    return new Control_Applicative.Applicative(function () {
        return listTApply(dictMonad);
    }, (function () {
        var $90 = Pipes["yield"](dictMonad);
        return function ($91) {
            return Select($90($91));
        };
    })());
};
var listTAlt = function (dictMonad) {
    return new Control_Alt.Alt(function () {
        return listTFunctor(dictMonad);
    }, function (v) {
        return function (v1) {
            return Control_Apply.applySecond(Pipes_Internal.applyProxy(dictMonad))(v)(v1);
        };
    });
};
var listTPlus = function (dictMonad) {
    return new Control_Plus.Plus(function () {
        return listTAlt(dictMonad);
    }, Control_Applicative.pure(Pipes_Internal.applicativeProxy(dictMonad))(Data_Unit.unit));
};
var listTAlternative = function (dictMonad) {
    return new Control_Alternative.Alternative(function () {
        return listTApplicative(dictMonad);
    }, function () {
        return listTPlus(dictMonad);
    });
};
var listTSemigroup = function (dictMonad) {
    return new Data_Semigroup.Semigroup(Control_Alt.alt(listTAlt(dictMonad)));
};
var listTMonoid = function (dictMonad) {
    return new Data_Monoid.Monoid(function () {
        return listTSemigroup(dictMonad);
    }, Control_Plus.empty(listTPlus(dictMonad)));
};
var errorTEnumerable = new Enumerable(function (dictMonad) {
    return function (m) {
        return Select(Control_Bind.bind(Pipes_Internal.bindProxy(dictMonad))(Control_Monad_Trans_Class.lift(Pipes_Internal.monadTransProxy)(dictMonad)(Control_Monad_Except_Trans.runExceptT(m)))(function (x) {
            if (x instanceof Data_Either.Left) {
                return Control_Applicative.pure(Pipes_Internal.applicativeProxy(dictMonad))(Data_Unit.unit);
            };
            if (x instanceof Data_Either.Right) {
                return Pipes["yield"](dictMonad)(x.value0);
            };
            throw new Error("Failed pattern match at Pipes.ListT (line 129, column 9 - line 131, column 31): " + [ x.constructor.name ]);
        }));
    };
});
var enumerate = function (v) {
    return v;
};
var every = function (dictMonad) {
    return function (dictEnumerable) {
        return function (it) {
            return Pipes_Core.composeRequest(dictMonad)(Pipes.discard(Pipes_Internal.monadProxy(dictMonad)))(enumerate(toListT(dictEnumerable)(dictMonad)(it)));
        };
    };
};
var listTBind = function (dictMonad) {
    return new Control_Bind.Bind(function () {
        return listTApply(dictMonad);
    }, function (v) {
        return function (f) {
            return Pipes["for"](dictMonad)(v)(function ($92) {
                return enumerate(f($92));
            });
        };
    });
};
var listTMonad = function (dictMonad) {
    return new Control_Monad.Monad(function () {
        return listTApplicative(dictMonad);
    }, function () {
        return listTBind(dictMonad);
    });
};
var listTMonadAsk = function (dictMonadAsk) {
    return new Control_Monad_Reader_Class.MonadAsk(function () {
        return listTMonad(dictMonadAsk.Monad0());
    }, Control_Monad_Trans_Class.lift(listTMonadTrans)(dictMonadAsk.Monad0())(Control_Monad_Reader_Class.ask(dictMonadAsk)));
};
var listTMonadReader = function (dictMonadReader) {
    return new Control_Monad_Reader_Class.MonadReader(function () {
        return listTMonadAsk(dictMonadReader.MonadAsk0());
    }, function (f) {
        return function (v) {
            return Control_Monad_Reader_Class.local(Pipes_Internal.proxyMonadReader(dictMonadReader))(f)(v);
        };
    });
};
var listTMonadEffect = function (dictMonadEffect) {
    return new Effect_Class.MonadEffect(function () {
        return listTMonad(dictMonadEffect.Monad0());
    }, (function () {
        var $93 = Control_Monad_Trans_Class.lift(listTMonadTrans)(dictMonadEffect.Monad0());
        var $94 = Effect_Class.liftEffect(dictMonadEffect);
        return function ($95) {
            return $93($94($95));
        };
    })());
};
var listTMonadState = function (dictMonadState) {
    return new Control_Monad_State_Class.MonadState(function () {
        return listTMonad(dictMonadState.Monad0());
    }, (function () {
        var $96 = Control_Monad_Trans_Class.lift(listTMonadTrans)(dictMonadState.Monad0());
        var $97 = Control_Monad_State_Class.state(dictMonadState);
        return function ($98) {
            return $96($97($98));
        };
    })());
};
var listTMonadTell = function (dictMonoid) {
    return function (dictMonadTell) {
        return new Control_Monad_Writer_Class.MonadTell(function () {
            return listTMonad(dictMonadTell.Monad0());
        }, (function () {
            var $99 = Control_Monad_Trans_Class.lift(listTMonadTrans)(dictMonadTell.Monad0());
            var $100 = Control_Monad_Writer_Class.tell(dictMonadTell);
            return function ($101) {
                return $99($100($101));
            };
        })());
    };
};
var listTMonadWriter = function (dictMonoid) {
    return function (dictMonadWriter) {
        return new Control_Monad_Writer_Class.MonadWriter(function () {
            return listTMonadTell(dictMonoid)(dictMonadWriter.MonadTell0());
        }, function (v) {
            var go = function (v1) {
                return function (w) {
                    if (v1 instanceof Pipes_Internal.Request) {
                        return new Pipes_Internal.Request(v1.value0, function (a) {
                            return go(v1.value1(a))(w);
                        });
                    };
                    if (v1 instanceof Pipes_Internal.Respond) {
                        return new Pipes_Internal.Respond(new Data_Tuple.Tuple(v1.value0, w), function (b$prime) {
                            return go(v1.value1(b$prime))(w);
                        });
                    };
                    if (v1 instanceof Pipes_Internal.M) {
                        return new Pipes_Internal.M(Control_Bind.bind(((dictMonadWriter.MonadTell0()).Monad0()).Bind1())(Control_Monad_Writer_Class.listen(dictMonadWriter)(v1.value0))(function (v2) {
                            return Control_Applicative.pure(((dictMonadWriter.MonadTell0()).Monad0()).Applicative0())(go(v2.value0)(Data_Semigroup.append(dictMonoid.Semigroup0())(w)(v2.value1)));
                        }));
                    };
                    if (v1 instanceof Pipes_Internal.Pure) {
                        return new Pipes_Internal.Pure(v1.value0);
                    };
                    throw new Error("Failed pattern match at Pipes.ListT (line 84, column 9 - line 84, column 62): " + [ v1.constructor.name, w.constructor.name ]);
                };
            };
            return go(v)(Data_Monoid.mempty(dictMonoid));
        }, function (v) {
            var go = function (v1) {
                return function (w) {
                    if (v1 instanceof Pipes_Internal.Request) {
                        return new Pipes_Internal.Request(v1.value0, function (a) {
                            return go(v1.value1(a))(w);
                        });
                    };
                    if (v1 instanceof Pipes_Internal.Respond) {
                        var _2 = function (v2) {
                            return v1.value0.value1(w);
                        };
                        var _1 = new Pipes_Internal.Respond(v1.value0.value0, function (b$prime) {
                            return go(v1.value1(b$prime))(v1.value0.value1(w));
                        });
                        return new Pipes_Internal.M(Control_Monad_Writer_Class.pass(dictMonadWriter)(Control_Applicative.pure(((dictMonadWriter.MonadTell0()).Monad0()).Applicative0())(new Data_Tuple.Tuple(_1, _2))));
                    };
                    if (v1 instanceof Pipes_Internal.M) {
                        return new Pipes_Internal.M(Control_Bind.bind(((dictMonadWriter.MonadTell0()).Monad0()).Bind1())(Control_Monad_Writer_Class.listen(dictMonadWriter)(v1.value0))(function (v2) {
                            return Control_Applicative.pure(((dictMonadWriter.MonadTell0()).Monad0()).Applicative0())(go(v2.value0)(Data_Semigroup.append(dictMonoid.Semigroup0())(w)(v2.value1)));
                        }));
                    };
                    if (v1 instanceof Pipes_Internal.Pure) {
                        return new Pipes_Internal.Pure(v1.value0);
                    };
                    throw new Error("Failed pattern match at Pipes.ListT (line 93, column 9 - line 93, column 72): " + [ v1.constructor.name, w.constructor.name ]);
                };
            };
            return go(v)(Data_Monoid.mempty(dictMonoid));
        });
    };
};
var listTMonadThrow = function (dictMonadThrow) {
    return new Control_Monad_Error_Class.MonadThrow(function () {
        return listTMonad(dictMonadThrow.Monad0());
    }, (function () {
        var $102 = Control_Monad_Trans_Class.lift(listTMonadTrans)(dictMonadThrow.Monad0());
        var $103 = Control_Monad_Error_Class.throwError(dictMonadThrow);
        return function ($104) {
            return $102($103($104));
        };
    })());
};
var listTMonadError = function (dictMonadError) {
    return new Control_Monad_Error_Class.MonadError(function () {
        return listTMonadThrow(dictMonadError.MonadThrow0());
    }, function (v) {
        return function (f) {
            return Control_Monad_Error_Class.catchError(Pipes_Internal.proxyMonadError(dictMonadError))(v)(function ($105) {
                return enumerate(f($105));
            });
        };
    });
};
var runListT = function (dictMonad) {
    return function (l) {
        return Pipes_Core.runEffect(dictMonad)(enumerate(Control_Apply.applySecond(listTApply(dictMonad))(l)(Control_Plus.empty(listTPlus(dictMonad)))));
    };
};
var runListTRec = function (dictMonadRec) {
    return function (l) {
        return Pipes_Core.runEffectRec(dictMonadRec)(enumerate(Control_Apply.applySecond(listTApply(dictMonadRec.Monad0()))(l)(Control_Plus.empty(listTPlus(dictMonadRec.Monad0())))));
    };
};
module.exports = {
    toListT: toListT,
    Select: Select,
    enumerate: enumerate,
    runListT: runListT,
    runListTRec: runListTRec,
    every: every,
    Enumerable: Enumerable,
    listTFunctor: listTFunctor,
    listTApply: listTApply,
    listTApplicative: listTApplicative,
    listTBind: listTBind,
    listTMonad: listTMonad,
    listTMonadTrans: listTMonadTrans,
    listTAlt: listTAlt,
    listTPlus: listTPlus,
    listTAlternative: listTAlternative,
    listTMonadEffect: listTMonadEffect,
    listTSemigroup: listTSemigroup,
    listTMonoid: listTMonoid,
    listTMonadState: listTMonadState,
    listTMonadTell: listTMonadTell,
    listTMonadWriter: listTMonadWriter,
    listTMonadAsk: listTMonadAsk,
    listTMonadReader: listTMonadReader,
    listTMonadThrow: listTMonadThrow,
    listTMonadError: listTMonadError,
    listTEnumerable: listTEnumerable,
    maybeTEnumerable: maybeTEnumerable,
    errorTEnumerable: errorTEnumerable
};
