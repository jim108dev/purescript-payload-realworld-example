// Generated by purs version 0.13.8
"use strict";
var $foreign = require("./foreign.js");
var Control_Bind = require("../Control.Bind/index.js");
var Data_Function = require("../Data.Function/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra/index.js");
var Effect = require("../Effect/index.js");
var Node_Buffer = require("../Node.Buffer/index.js");
var Node_Buffer_Class = require("../Node.Buffer.Class/index.js");
var Node_Crypto_Hash = require("../Node.Crypto.Hash/index.js");
var Node_Crypto_Hmac = require("../Node.Crypto.Hmac/index.js");
var Node_Encoding = require("../Node.Encoding/index.js");
var timingSafeEqualString = function (x1) {
    return function (x2) {
        return function __do() {
            var a1 = Node_Buffer_Class.fromString(Node_Buffer.mutableBufferEffect)(x1)(Node_Encoding.UTF8.value)();
            var a2 = Node_Buffer_Class.fromString(Node_Buffer.mutableBufferEffect)(x2)(Node_Encoding.UTF8.value)();
            var secret = Control_Bind.bind(Effect.bindEffect)($foreign.randomBytes(32))(Node_Buffer_Class.toString(Node_Buffer.mutableBufferEffect)(Node_Encoding.UTF8.value))();
            var b1 = Control_Bind.bind(Effect.bindEffect)(Control_Bind.bind(Effect.bindEffect)(Node_Crypto_Hmac.createHmac(Node_Crypto_Hash.SHA256.value)(secret))(Data_Function.flip(Node_Crypto_Hmac.update)(a1)))(Node_Crypto_Hmac.digest)();
            var b2 = Control_Bind.bind(Effect.bindEffect)(Control_Bind.bind(Effect.bindEffect)(Node_Crypto_Hmac.createHmac(Node_Crypto_Hash.SHA256.value)(secret))(Data_Function.flip(Node_Crypto_Hmac.update)(a2)))(Node_Crypto_Hmac.digest)();
            return Data_Functor.map(Effect.functorEffect)(Data_HeytingAlgebra.conj(Data_HeytingAlgebra.heytingAlgebraBoolean)(x1 === x2))($foreign.timingSafeEqual(b1)(b2))();
        };
    };
};
module.exports = {
    timingSafeEqualString: timingSafeEqualString,
    timingSafeEqual: $foreign.timingSafeEqual,
    randomBytes: $foreign.randomBytes
};
