// Generated by purs version 0.13.8
"use strict";
var $foreign = require("./foreign.js");
var Control_Bind = require("../Control.Bind/index.js");
var Data_Function = require("../Data.Function/index.js");
var Data_Show = require("../Data.Show/index.js");
var Effect = require("../Effect/index.js");
var Node_Buffer = require("../Node.Buffer/index.js");
var Node_Buffer_Class = require("../Node.Buffer.Class/index.js");
var Node_Crypto_Hash = require("../Node.Crypto.Hash/index.js");
var Node_Encoding = require("../Node.Encoding/index.js");
var createHmac = function (alg) {
    return function (secret) {
        return $foreign["_createHmac"](Data_Show.show(Node_Crypto_Hash.showAlgorithm)(alg))(secret);
    };
};
var hmac = function (alg) {
    return function (secret) {
        return function (str) {
            return function (enc) {
                return function __do() {
                    var buf = Node_Buffer_Class.fromString(Node_Buffer.mutableBufferEffect)(str)(Node_Encoding.UTF8.value)();
                    return Control_Bind.bind(Effect.bindEffect)(Control_Bind.bind(Effect.bindEffect)(Control_Bind.bind(Effect.bindEffect)(createHmac(alg)(secret))(Data_Function.flip($foreign.update)(buf)))($foreign.digest))(Node_Buffer_Class.toString(Node_Buffer.mutableBufferEffect)(enc))();
                };
            };
        };
    };
};
var hex = function (alg) {
    return function (secret) {
        return function (str) {
            return hmac(alg)(secret)(str)(Node_Encoding.Hex.value);
        };
    };
};
var base64 = function (alg) {
    return function (secret) {
        return function (str) {
            return hmac(alg)(secret)(str)(Node_Encoding.Base64.value);
        };
    };
};
module.exports = {
    hex: hex,
    base64: base64,
    createHmac: createHmac,
    update: $foreign.update,
    digest: $foreign.digest
};
